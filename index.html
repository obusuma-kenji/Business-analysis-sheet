<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁßÅ„ÅÆ‰ΩúÊ•≠Ë®òÈå≤</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background: #f5f6fa;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .add-work {
            background: #ecf0f1;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .add-work h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            font-size: 1em;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .add-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
        }
        
        .add-btn:hover {
            background: #219a52;
        }
        
        .work-list {
            margin-bottom: 30px;
        }
        
        .work-list h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .work-item {
            background: #fff;
            border: 1px solid #ecf0f1;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 12px;
            position: relative;
            min-height: 90px;
        }
        
        .work-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .work-details {
            color: #7f8c8d;
            font-size: 0.95em;
        }
        
        .work-time {
            position: absolute;
            right: 20px;
            top: 20px;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        .delete-btn {
            position: absolute;
            right: 20px;
            bottom: 15px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .summary {
            background: #3498db;
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .summary h2 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .summary-numbers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .chart-section {
            background: white;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #ecf0f1;
        }
        
        .chart-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3em;
        }
        
        .diagnosis-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }
        
        .diagnosis-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .diagnosis-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #ddd;
        }
        
        .diagnosis-item.high {
            border-left-color: #27ae60;
            background: #f8fff8;
        }
        
        .diagnosis-item.medium {
            border-left-color: #f39c12;
            background: #fffbf0;
        }
        
        .diagnosis-item.low {
            border-left-color: #e74c3c;
            background: #fff5f5;
        }
        
        .diagnosis-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .diagnosis-score {
            background: #3498db;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        .diagnosis-score.high { background: #27ae60; }
        .diagnosis-score.medium { background: #f39c12; }
        .diagnosis-score.low { background: #e74c3c; }
        
        .diagnosis-details {
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        
        .diagnosis-recommendation {
            color: #2c3e50;
            font-weight: 500;
            background: rgba(52, 152, 219, 0.1);
            padding: 10px;
            border-radius: 4px;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .no-data {
            text-align: center;
            color: #95a5a6;
            padding: 40px;
            font-size: 1.1em;
        }
        
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 20px;
            float: right;
        }
        
        @media (max-width: 600px) {
            .input-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .summary-numbers {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .work-time,
            .automation-score {
                position: static;
                display: inline-block;
                margin-top: 10px;
                margin-right: 10px;
            }
            
            .delete-btn {
                position: static;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ RPA/Ëá™ÂãïÂåñ Ë®∫Êñ≠„ÉÑ„Éº„É´</h1>
            <p>‰ΩúÊ•≠„ÇíË®òÈå≤„Åô„Çã„Å®„ÄÅRPA„ÉªËá™ÂãïÂåñ„ÉªDXÂåñ„ÅÆÂèØËÉΩÊÄß„ÇíÂç≥Â∫ß„Å´Ë®∫Êñ≠„Åó„Åæ„Åô</p>
        </div>
        
        <div class="content">
            <!-- ‰ΩúÊ•≠ËøΩÂä†„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="add-work">
                <h2>‰ΩúÊ•≠„ÇíË®òÈå≤„Åô„Çã</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>„Å©„Çì„Å™‰ΩúÊ•≠„Åß„Åô„ÅãÔºü</label>
                        <input type="text" id="workName" placeholder="‰æãÔºö„É°„Éº„É´„ÉÅ„Çß„ÉÉ„ÇØ">
                    </div>
                    <div class="input-group">
                        <label>„Å©„ÅÆ„Åè„Çâ„ÅÑ„ÅÆÈ†ªÂ∫¶Ôºü</label>
                        <select id="frequency">
                            <option value="">ÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ</option>
                            <option value="5">ÊØéÊó•</option>
                            <option value="3">ÈÄ±3Âõû„Åè„Çâ„ÅÑ</option>
                            <option value="2">ÈÄ±2Âõû„Åè„Çâ„ÅÑ</option>
                            <option value="1">ÈÄ±1Âõû</option>
                            <option value="0.5">Êúà„Å´Êï∞Âõû</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>1Âõû‰ΩïÂàÜ„Åè„Çâ„ÅÑÔºü</label>
                        <input type="number" id="duration" placeholder="30" min="1">
                    </div>
                </div>
                <button class="add-btn" onclick="addWork()">Ë®òÈå≤„Åô„Çã</button>
            </div>
            
            <!-- Ë®òÈå≤„Åó„Åü‰ΩúÊ•≠‰∏ÄË¶ß -->
            <div class="work-list">
                <h2>Ë®òÈå≤„Åó„Åü‰ΩúÊ•≠</h2>
                <div id="workItems"></div>
            </div>
            
            <!-- ÂêàË®àÊôÇÈñìË°®Á§∫ -->
            <div class="summary" id="summary" style="display: none;">
                <h2>„ÅÇ„Å™„Åü„ÅÆ‰ΩúÊ•≠ÊôÇÈñì</h2>
                <div class="summary-numbers">
                    <div class="summary-item">
                        <div class="summary-number" id="weeklyHours">0</div>
                        <div class="summary-label">ÈÄ±ÈñìÂêàË®àÔºàÊôÇÈñìÔºâ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="monthlyHours">0</div>
                        <div class="summary-label">ÊúàÈñìÂêàË®àÔºàÊôÇÈñìÔºâ</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="taskCount">0</div>
                        <div class="summary-label">Ë®òÈå≤„Åó„Åü‰ΩúÊ•≠Êï∞</div>
                    </div>
                </div>
            </div>
            
            <!-- Ë®∫Êñ≠ÁµêÊûú -->
            <div class="diagnosis-section" id="diagnosis" style="display: none;">
                <h2>ü§ñ Ëá™ÂãïÂåñË®∫Êñ≠ÁµêÊûú</h2>
                <div id="diagnosisResults"></div>
            </div>
            
            <!-- „Ç∞„É©„ÉïË°®Á§∫ -->
            <div class="chart-section">
                <h2>‰ΩúÊ•≠ÊôÇÈñì„ÅÆÂÜÖË®≥ÔºàËâ≤„ÅØËá™ÂãïÂåñÂèØËÉΩÊÄß„ÇíË°®Á§∫Ôºâ</h2>
                <div class="chart-container">
                    <canvas id="workChart" style="display: none;"></canvas>
                    <div class="no-data" id="noData">‰ΩúÊ•≠„ÇíË®òÈå≤„Åô„Çã„Å®„ÄÅÊôÇÈñì„ÅÆ‰Ωø„ÅÑÊñπ„Åå„Ç∞„É©„Éï„ÅßË¶ã„Åà„Åæ„Åô</div>
                </div>
                <div class="chart-legend" style="margin-top: 15px; text-align: center; font-size: 0.9em; color: #7f8c8d;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #27ae60; border-radius: 50%; margin-right: 5px;"></span>Ëá™ÂãïÂåñÊé®Â•®
                    <span style="display: inline-block; width: 12px; height: 12px; background: #f39c12; border-radius: 50%; margin: 0 5px 0 15px;"></span>ÂäπÁéáÂåñÂèØËÉΩ
                    <span style="display: inline-block; width: 12px; height: 12px; background: #e74c3c; border-radius: 50%; margin: 0 5px 0 15px;"></span>Ë¶ÅÊ§úË®é
                </div>
            </div>
            
            <button class="reset-btn" onclick="resetAll()">„Åô„Åπ„Å¶„ÇØ„É™„Ç¢</button>
        </div>
    </div>

    <script>
        let works = [];
        let chart = null;
        
        // ‰ΩúÊ•≠„ÇíËøΩÂä†
        function addWork() {
            const name = document.getElementById('workName').value.trim();
            const freq = parseFloat(document.getElementById('frequency').value);
            const duration = parseInt(document.getElementById('duration').value);
            
            if (!name || !freq || !duration) {
                alert('„Åô„Åπ„Å¶ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const weeklyHours = (freq * duration) / 60;
            
            const work = {
                id: Date.now(),
                name: name,
                frequency: freq,
                duration: duration,
                weeklyHours: Math.round(weeklyHours * 10) / 10
            };
            
            works.push(work);
            
            // Âç≥Â∫ß„Å´Ë®∫Êñ≠ÁµêÊûú„ÇíË°®Á§∫
            const diagnosis = diagnoseAutomation(name, freq, duration);
            showInstantDiagnosis(work, diagnosis);
            
            updateDisplay();
            clearInputs();
            saveToStorage();
        }
        
        // Âç≥Â∫ß„Å´Ë®∫Êñ≠ÁµêÊûú„ÇíË°®Á§∫
        function showInstantDiagnosis(work, diagnosis) {
            const message = `
üìä „Äå${work.name}„Äç„ÅÆË®∫Êñ≠ÂÆå‰∫ÜÔºÅ

üéØ Ëá™ÂãïÂåñÂèØËÉΩÊÄß: ${diagnosis.score}% (${diagnosis.levelText})

üí° ÂÖ∑‰ΩìÁöÑ„Å™ÊîπÂñÑÊ°à:
${diagnosis.recommendation}

üõ†Ô∏è Ê¨°„Å´„Åô„Åπ„Åç„Åì„Å®:
${diagnosis.specificAction}

‚è±Ô∏è ÁèæÂú®„ÅÆË≤†Ëç∑: ÈÄ±${work.weeklyHours}ÊôÇÈñì

${diagnosis.score >= 70 ? '‚úÖ „ÄêÂÑ™ÂÖàÂ∫¶ÔºöÈ´ò„Äë„Åô„Åê„Å´RPA/Ëá™ÂãïÂåñ„ÇíÊ§úË®é„Åô„Çã„Åì„Å®„ÇíÂº∑„Åè„ÅäÂãß„ÇÅ„Åó„Åæ„ÅôÔºÅ' : 
  diagnosis.score >= 40 ? '‚ö° „ÄêÂÑ™ÂÖàÂ∫¶Ôºö‰∏≠„ÄëÂäπÁéáÂåñ„Å´„Çà„ÇäÂ§ßÂπÖ„Å™ÊôÇÈñìÂâäÊ∏õ„ÅåÊúüÂæÖ„Åß„Åç„Åæ„Åô„ÄÇ' : 
  'ü§î „ÄêÂÑ™ÂÖàÂ∫¶Ôºö‰Ωé„ÄëÁèæÁä∂„Åß„ÅØ‰∫∫Èñì„ÅÆ‰ΩúÊ•≠„ÅåÈÅ©„Åó„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅÊâãÈ†Ü„ÅÆË¶ãÁõ¥„Åó„ÅØÂèØËÉΩ„Åß„Åô„ÄÇ'}
            `;
            
            setTimeout(() => alert(message), 500);
        }
        
        // ‰ΩúÊ•≠„ÇíÂâäÈô§
        function deleteWork(id) {
            if (confirm('„Åì„ÅÆ‰ΩúÊ•≠„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                works = works.filter(work => work.id !== id);
                updateDisplay();
                saveToStorage();
            }
        }
        
        // ÁîªÈù¢„ÇíÊõ¥Êñ∞
        function updateDisplay() {
            updateWorkList();
            updateSummary();
            updateChart();
            updateDiagnosis();
        }
        
        // Ë®∫Êñ≠ÁµêÊûú„ÇíÊõ¥Êñ∞
        function updateDiagnosis() {
            const diagnosisDiv = document.getElementById('diagnosis');
            const container = document.getElementById('diagnosisResults');
            
            if (works.length === 0) {
                diagnosisDiv.style.display = 'none';
                return;
            }
            
            // Ëá™ÂãïÂåñ„Çπ„Ç≥„Ç¢È†Ü„Å´„ÇΩ„Éº„Éà
            const sortedWorks = works.map(work => ({
                ...work,
                diagnosis: diagnoseAutomation(work.name, work.frequency, work.duration)
            })).sort((a, b) => b.diagnosis.score - a.diagnosis.score);
            
            container.innerHTML = sortedWorks.map((work, index) => {
                const d = work.diagnosis;
                return `
                    <div class="diagnosis-item ${d.level}">
                        <div class="diagnosis-title">
                            ${index + 1}. ${work.name}
                            <span class="diagnosis-score ${d.level}">${d.levelText} ${d.score}%</span>
                        </div>
                        <div class="diagnosis-details">
                            ÈÄ±${work.weeklyHours}ÊôÇÈñì (${getFrequencyText(work.frequency)} √ó ${work.duration}ÂàÜ)
                            ${d.reasons.length > 0 ? '„Éª' + d.reasons.join('„Éª') : ''}
                        </div>
                        <div class="diagnosis-recommendation">
                            üí° ÂäπÊûú‰∫àÊ∏¨: ${d.recommendation}
                        </div>
                        <div class="diagnosis-recommendation" style="margin-top: 8px; background: rgba(52, 152, 219, 0.15);">
                            üõ†Ô∏è ÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„ÇØ„Ç∑„Éß„É≥: ${d.specificAction}
                        </div>
                    </div>
                `;
            }).join('');
            
            diagnosisDiv.style.display = 'block';
        }
        
        // ‰ΩúÊ•≠‰∏ÄË¶ß„ÇíÊõ¥Êñ∞
        function updateWorkList() {
            const container = document.getElementById('workItems');
            
            if (works.length === 0) {
                container.innerHTML = '<div class="no-data">„Åæ„Å†‰ΩúÊ•≠„ÅåË®òÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</div>';
                return;
            }
            
            container.innerHTML = works.map(work => {
                const freqText = getFrequencyText(work.frequency);
                const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                
                return `
                    <div class="work-item">
                        <div class="work-name">${work.name}</div>
                        <div class="work-details">${freqText} √ó ${work.duration}ÂàÜ</div>
                        <div class="work-time">ÈÄ±${work.weeklyHours}ÊôÇÈñì</div>
                        <div class="automation-score" style="background: ${diagnosis.color}; position: absolute; right: 20px; top: 45px; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">
                            ${diagnosis.levelText} ${diagnosis.score}%
                        </div>
                        <button class="delete-btn" onclick="deleteWork(${work.id})">ÂâäÈô§</button>
                    </div>
                `;
            }).join('');
        }
        
        // È†ªÂ∫¶„Çí„ÉÜ„Ç≠„Çπ„Éà„Å´Â§âÊèõ
        function getFrequencyText(freq) {
            if (freq === 5) return 'ÊØéÊó•';
            if (freq === 3) return 'ÈÄ±3Âõû';
            if (freq === 2) return 'ÈÄ±2Âõû';
            if (freq === 1) return 'ÈÄ±1Âõû';
            if (freq === 0.5) return 'ÊúàÊï∞Âõû';
            return `ÈÄ±${freq}Âõû`;
        }
        
        // „Çµ„Éû„É™„Éº„ÇíÊõ¥Êñ∞
        function updateSummary() {
            const summaryDiv = document.getElementById('summary');
            
            if (works.length === 0) {
                summaryDiv.style.display = 'none';
                return;
            }
            
            const totalWeekly = works.reduce((sum, work) => sum + work.weeklyHours, 0);
            const totalMonthly = totalWeekly * 4.3;
            
            document.getElementById('weeklyHours').textContent = totalWeekly.toFixed(1);
            document.getElementById('monthlyHours').textContent = Math.round(totalMonthly);
            document.getElementById('taskCount').textContent = works.length;
            
            summaryDiv.style.display = 'block';
        }
        
        // Ëá™ÂãïÂåñÂèØËÉΩÊÄß„ÇíË®∫Êñ≠
        function diagnoseAutomation(workName, frequency, duration) {
            const weeklyMinutes = frequency * duration;
            let score = 0;
            let reasons = [];
            let recommendation = '';
            let specificAction = '';
            
            // Âü∫Êú¨„Çπ„Ç≥„Ç¢ÔºàÊôÇÈñì„Å®È†ªÂ∫¶Ôºâ
            if (weeklyMinutes >= 120) { // ÈÄ±2ÊôÇÈñì‰ª•‰∏ä
                score += 30;
                reasons.push('ÈÄ±2ÊôÇÈñì‰ª•‰∏ä„ÅÆ‰ΩúÊ•≠');
            }
            if (frequency >= 3) { // ÈÄ±3Âõû‰ª•‰∏ä
                score += 25;
                reasons.push('È†ªÁπÅ„Å´ÂÆüÊñΩ');
            }
            
            // ‰ΩúÊ•≠ÂÜÖÂÆπ„Å´„Çà„ÇãË©≥Á¥∞Âà§ÂÆö
            const name = workName.toLowerCase();
            if (name.includes('„Éá„Éº„Çø') || name.includes('ÂÖ•Âäõ') || name.includes('Ëª¢Ë®ò') || name.includes('„Ç≥„Éî„Éº')) {
                score += 40;
                reasons.push('„Éá„Éº„ÇøÂá¶ÁêÜ‰ΩúÊ•≠');
                recommendation = 'RPAÂ∞éÂÖ•„Åß80-95%ÂâäÊ∏õÂèØËÉΩ';
                specificAction = 'Power Automate Desktop „ÇÑ UiPathÁ≠â„ÅÆRPA„ÉÑ„Éº„É´„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (name.includes('„É°„Éº„É´') || name.includes('ÈÄ£Áµ°') || name.includes('Ëøî‰ø°')) {
                score += 30;
                reasons.push('ÂÆöÂûãÁöÑ„Å™„ÇÑ„Çä„Å®„Çä');
                recommendation = '„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂåñ„ÉªËá™ÂãïËøî‰ø°„Åß50-70%ÂâäÊ∏õÂèØËÉΩ';
                specificAction = 'Outlook„ÅÆÂÆöÂûãÊñáÊ©üËÉΩ„ÇÑËá™ÂãïÊåØ„ÇäÂàÜ„Åë„É´„Éº„É´„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (name.includes('ÈõÜË®à') || name.includes('Ë®àÁÆó') || name.includes('„É¨„Éù„Éº„Éà') || name.includes('Â†±Âëä')) {
                score += 35;
                reasons.push('Ë®àÁÆó„ÉªÈõÜË®à‰ΩúÊ•≠');
                recommendation = 'ExcelËá™ÂãïÂåñ„ÉªBI„ÉÑ„Éº„É´„Åß70-90%ÂâäÊ∏õÂèØËÉΩ';
                specificAction = 'Excel„Éû„ÇØ„É≠‰ΩúÊàê„ÄÅ„Åæ„Åü„ÅØPower BI„Å™„Å©„ÅÆBI„ÉÑ„Éº„É´Â∞éÂÖ•„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (name.includes('Ë´ãÊ±Ç') || name.includes('Áô∫Ê≥®') || name.includes('Êõ∏È°û') || name.includes('Â•ëÁ¥Ñ')) {
                score += 35;
                reasons.push('ÂÆöÂûãÊõ∏È°ûÂá¶ÁêÜ');
                recommendation = 'ÈõªÂ≠êÂåñ„ÉªËá™ÂãïÂá¶ÁêÜ„Åß60-80%ÂâäÊ∏õÂèØËÉΩ';
                specificAction = '„ÇØ„É©„Ç¶„ÉâË´ãÊ±ÇÊõ∏„Ç∑„Çπ„ÉÜ„É†„ÇÑÈõªÂ≠êÂ•ëÁ¥Ñ„Çµ„Éº„Éì„Çπ„ÅÆÂ∞éÂÖ•„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (name.includes('Âú®Â∫´') || name.includes('Áô∫Ê≥®') || name.includes('ÁÆ°ÁêÜ')) {
                score += 30;
                reasons.push('ÁÆ°ÁêÜÊ•≠Âãô');
                recommendation = 'ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•„Åß40-70%ÂâäÊ∏õÂèØËÉΩ';
                specificAction = 'Âú®Â∫´ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†„ÇÑÁô∫Ê≥®„Ç∑„Çπ„ÉÜ„É†„ÅÆÂ∞éÂÖ•„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (name.includes('ÈõªË©±') || name.includes('Êé•ÂÆ¢') || name.includes('Áõ∏Ë´á') || name.includes('ÂØæÂøú')) {
                score += 10;
                reasons.push('‰∫∫„Å®„ÅÆÂØæË©±„ÅåÂøÖË¶Å');
                recommendation = 'FAQ„Éª„ÉÅ„É£„ÉÉ„Éà„Éú„ÉÉ„ÉàÁ≠â„Åß‰∏ÄÈÉ®ÊîØÊè¥ÂèØËÉΩ';
                specificAction = '„Çà„Åè„ÅÇ„ÇãË≥™Âïè„ÅÆFAQ‰ΩúÊàê„ÇÑ„ÉÅ„É£„ÉÉ„Éà„Éú„ÉÉ„ÉàÂ∞éÂÖ•„ÅßÂØæÂøúÊï∞„ÇíÊ∏õ„Çâ„Åõ„Åæ„Åô';
            } else {
                score += 20;
                recommendation = 'Ê•≠ÂãôÂÜÖÂÆπ„ÅÆË©≥Á¥∞Á¢∫Ë™ç„ÅåÂøÖË¶Å';
                specificAction = '‰ΩúÊ•≠ÊâãÈ†Ü„ÇíË©≥„Åó„ÅèÂàÜÊûê„Åó„ÄÅÂÆöÂûãÈÉ®ÂàÜ„ÅÆËá™ÂãïÂåñ„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            }
            
            // „Çπ„Ç≥„Ç¢Ë™øÊï¥
            score = Math.min(100, Math.max(0, score));
            
            // Âà§ÂÆö„É¨„Éô„É´
            let level = 'low';
            let levelText = 'Ë¶ÅÊ§úË®é';
            let color = '#e74c3c';
            
            if (score >= 70) {
                level = 'high';
                levelText = 'RPAÂ∞éÂÖ•Êé®Â•®';
                color = '#27ae60';
            } else if (score >= 40) {
                level = 'medium';
                levelText = 'ÂäπÁéáÂåñÂèØËÉΩ';
                color = '#f39c12';
            }
            
            return {
                score,
                level,
                levelText,
                color,
                reasons,
                recommendation,
                specificAction
            };
        }

        // „ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞
        function updateChart() {
            const canvas = document.getElementById('workChart');
            const noData = document.getElementById('noData');
            
            if (works.length === 0) {
                canvas.style.display = 'none';
                noData.style.display = 'block';
                if (chart) {
                    chart.destroy();
                    chart = null;
                }
                return;
            }
            
            canvas.style.display = 'block';
            noData.style.display = 'none';
            
            if (chart) {
                chart.destroy();
            }
            
            const ctx = canvas.getContext('2d');
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: works.map(work => work.name),
                    datasets: [{
                        data: works.map(work => work.weeklyHours),
                        backgroundColor: works.map(work => {
                            const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                            return diagnosis.color;
                        }),
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const work = works[context.dataIndex];
                                    const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                                    return [
                                        context.label + ': ' + context.parsed + 'ÊôÇÈñì/ÈÄ±',
                                        'Ëá™ÂãïÂåñÂ∫¶: ' + diagnosis.score + '% (' + diagnosis.levelText + ')'
                                    ];
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // ÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ„Çí„ÇØ„É™„Ç¢
        function clearInputs() {
            document.getElementById('workName').value = '';
            document.getElementById('frequency').value = '';
            document.getElementById('duration').value = '';
        }
        
        // „Åô„Åπ„Å¶„ÇØ„É™„Ç¢
        function resetAll() {
            if (confirm('„Åô„Åπ„Å¶„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                works = [];
                updateDisplay();
                saveToStorage();
            }
        }
        
        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò
        function saveToStorage() {
            localStorage.setItem('workRecords', JSON.stringify(works));
        }
        
        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„ÇâË™≠„ÅøËæº„Åø
        function loadFromStorage() {
            const saved = localStorage.getItem('workRecords');
            if (saved) {
                works = JSON.parse(saved);
                updateDisplay();
            }
        }
        
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂá¶ÁêÜ
        document.addEventListener('DOMContentLoaded', function() {
            loadFromStorage();
            
            // „Éá„É¢Áî®ÔºàÂâäÈô§ÂèØËÉΩÔºâ
            setTimeout(() => {
                if (works.length === 0 && confirm('„Éá„É¢Áî®„ÅÆ„Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÇíË°®Á§∫„Åó„Åæ„Åô„ÅãÔºü')) {
                    const samples = [
                        { name: '„É°„Éº„É´„ÉÅ„Çß„ÉÉ„ÇØ', frequency: 5, duration: 20 },
                        { name: '„Éá„Éº„ÇøÂÖ•Âäõ', frequency: 3, duration: 45 },
                        { name: 'ÈõªË©±ÂØæÂøú', frequency: 5, duration: 15 }
                    ];
                    
                    samples.forEach(sample => {
                        const weeklyHours = (sample.frequency * sample.duration) / 60;
                        works.push({
                            id: Date.now() + Math.random(),
                            name: sample.name,
                            frequency: sample.frequency,
                            duration: sample.duration,
                            weeklyHours: Math.round(weeklyHours * 10) / 10
                        });
                    });
                    
                    updateDisplay();
                    saveToStorage();
                }
            }, 1000);
        });
    </script>
</body>
</html>