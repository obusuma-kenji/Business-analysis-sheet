<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§ã®ä½œæ¥­è¨˜éŒ²</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background: #f5f6fa;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .add-work {
            background: #ecf0f1;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .add-work h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            font-size: 1em;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .add-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
        }
        
        .add-btn:hover {
            background: #219a52;
        }
        
        .work-list {
            margin-bottom: 30px;
        }
        
        .work-list h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .work-item {
            background: #fff;
            border: 1px solid #ecf0f1;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 12px;
            position: relative;
            min-height: 90px;
        }
        
        .work-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .work-details {
            color: #7f8c8d;
            font-size: 0.95em;
        }
        
        .work-time {
            position: absolute;
            right: 20px;
            top: 20px;
            background: #3498db;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        .delete-btn {
            position: absolute;
            right: 20px;
            bottom: 15px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .summary {
            background: #3498db;
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .summary h2 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .summary-numbers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .chart-section {
            background: white;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #ecf0f1;
        }
        
        .chart-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3em;
        }
        
        .diagnosis-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }
        
        .diagnosis-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .diagnosis-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #ddd;
        }
        
        .diagnosis-item.high {
            border-left-color: #27ae60;
            background: #f8fff8;
        }
        
        .diagnosis-item.medium {
            border-left-color: #f39c12;
            background: #fffbf0;
        }
        
        .diagnosis-item.low {
            border-left-color: #e74c3c;
            background: #fff5f5;
        }
        
        .diagnosis-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .diagnosis-score {
            background: #3498db;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        .diagnosis-score.high { background: #27ae60; }
        .diagnosis-score.medium { background: #f39c12; }
        .diagnosis-score.low { background: #e74c3c; }
        
        .diagnosis-details {
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        
        .diagnosis-recommendation {
            color: #2c3e50;
            font-weight: 500;
            background: rgba(52, 152, 219, 0.1);
            padding: 10px;
            border-radius: 4px;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .no-data {
            text-align: center;
            color: #95a5a6;
            padding: 40px;
            font-size: 1.1em;
        }
        
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 20px;
            float: right;
        }
        
        @media (max-width: 600px) {
            .input-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .summary-numbers {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .work-time,
            .automation-score {
                position: static;
                display: inline-block;
                margin-top: 10px;
                margin-right: 10px;
            }
            
            .delete-btn {
                position: static;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– RPA/è‡ªå‹•åŒ– è¨ºæ–­ãƒ„ãƒ¼ãƒ«</h1>
            <p>ä½œæ¥­ã‚’è¨˜éŒ²ã™ã‚‹ã¨ã€RPAãƒ»è‡ªå‹•åŒ–ãƒ»DXåŒ–ã®å¯èƒ½æ€§ã‚’å³åº§ã«è¨ºæ–­ã—ã¾ã™</p>
        </div>
        
        <div class="content">
            <!-- ä½œæ¥­è¿½åŠ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="add-work">
                <h2>ä½œæ¥­ã‚’è¨˜éŒ²ã™ã‚‹</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>ã©ã‚“ãªä½œæ¥­ã§ã™ã‹ï¼Ÿ</label>
                        <input type="text" id="workName" placeholder="ä¾‹ï¼šãƒ¡ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯">
                    </div>
                    <div class="input-group">
                        <label>ã©ã®ãã‚‰ã„ã®é »åº¦ï¼Ÿ</label>
                        <select id="frequency">
                            <option value="">é¸ã‚“ã§ãã ã•ã„</option>
                            <option value="5">æ¯æ—¥</option>
                            <option value="3">é€±3å›ãã‚‰ã„</option>
                            <option value="2">é€±2å›ãã‚‰ã„</option>
                            <option value="1">é€±1å›</option>
                            <option value="0.5">æœˆã«æ•°å›</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>1å›ä½•åˆ†ãã‚‰ã„ï¼Ÿ</label>
                        <input type="number" id="duration" placeholder="30" min="1">
                    </div>
                </div>
                <button class="add-btn" onclick="addWork()">è¨˜éŒ²ã™ã‚‹</button>
            </div>
            
            <!-- è¨˜éŒ²ã—ãŸä½œæ¥­ä¸€è¦§ -->
            <div class="work-list">
                <h2>è¨˜éŒ²ã—ãŸä½œæ¥­</h2>
                <div id="workItems"></div>
            </div>
            
            <!-- åˆè¨ˆæ™‚é–“è¡¨ç¤º -->
            <div class="summary" id="summary" style="display: none;">
                <h2>ã‚ãªãŸã®ä½œæ¥­æ™‚é–“</h2>
                <div class="summary-numbers">
                    <div class="summary-item">
                        <div class="summary-number" id="weeklyHours">0</div>
                        <div class="summary-label">é€±é–“åˆè¨ˆï¼ˆæ™‚é–“ï¼‰</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="monthlyHours">0</div>
                        <div class="summary-label">æœˆé–“åˆè¨ˆï¼ˆæ™‚é–“ï¼‰</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-number" id="taskCount">0</div>
                        <div class="summary-label">è¨˜éŒ²ã—ãŸä½œæ¥­æ•°</div>
                    </div>
                </div>
            </div>
            
            <!-- è¨ºæ–­çµæœ -->
            <div class="diagnosis-section" id="diagnosis" style="display: none;">
                <h2>ğŸ¤– è‡ªå‹•åŒ–è¨ºæ–­çµæœ</h2>
                <div id="diagnosisResults"></div>
            </div>
            
            <!-- ã‚°ãƒ©ãƒ•è¡¨ç¤º -->
            <div class="chart-section">
                <h2>ä½œæ¥­æ™‚é–“ã®å†…è¨³ï¼ˆè‰²ã¯è‡ªå‹•åŒ–å¯èƒ½æ€§ã‚’è¡¨ç¤ºï¼‰</h2>
                <div class="chart-container">
                    <canvas id="workChart" style="display: none;"></canvas>
                    <div class="no-data" id="noData">ä½œæ¥­ã‚’è¨˜éŒ²ã™ã‚‹ã¨ã€æ™‚é–“ã®ä½¿ã„æ–¹ãŒã‚°ãƒ©ãƒ•ã§è¦‹ãˆã¾ã™</div>
                </div>
                <div class="chart-legend" style="margin-top: 15px; text-align: center; font-size: 0.9em; color: #7f8c8d;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #27ae60; border-radius: 50%; margin-right: 5px;"></span>è‡ªå‹•åŒ–æ¨å¥¨
                    <span style="display: inline-block; width: 12px; height: 12px; background: #f39c12; border-radius: 50%; margin: 0 5px 0 15px;"></span>åŠ¹ç‡åŒ–å¯èƒ½
                    <span style="display: inline-block; width: 12px; height: 12px; background: #e74c3c; border-radius: 50%; margin: 0 5px 0 15px;"></span>è¦æ¤œè¨
                </div>
            </div>
            
            <button class="reset-btn" onclick="resetAll()">ã™ã¹ã¦ã‚¯ãƒªã‚¢</button>
        </div>
    </div>

    <script>
        let works = [];
        let chart = null;
        
        // ä½œæ¥­ã‚’è¿½åŠ 
        function addWork() {
            const name = document.getElementById('workName').value.trim();
            const freq = parseFloat(document.getElementById('frequency').value);
            const duration = parseInt(document.getElementById('duration').value);
            
            if (!name || !freq || !duration) {
                alert('ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            const weeklyHours = (freq * duration) / 60;
            
            const work = {
                id: Date.now(),
                name: name,
                frequency: freq,
                duration: duration,
                weeklyHours: Math.round(weeklyHours * 10) / 10
            };
            
            works.push(work);
            
            // å³åº§ã«è¨ºæ–­çµæœã‚’è¡¨ç¤º
            const diagnosis = diagnoseAutomation(name, freq, duration);
            showInstantDiagnosis(work, diagnosis);
            
            updateDisplay();
            clearInputs();
            saveToStorage();
        }
        
        // å³åº§ã«è¨ºæ–­çµæœã‚’è¡¨ç¤º
        function showInstantDiagnosis(work, diagnosis) {
            const message = `
ğŸ“Š ã€Œ${work.name}ã€ã®è¨ºæ–­å®Œäº†ï¼

ğŸ¯ è‡ªå‹•åŒ–å¯èƒ½æ€§: ${diagnosis.score}% (${diagnosis.levelText})

ğŸ’¡ å…·ä½“çš„ãªæ”¹å–„æ¡ˆ:
${diagnosis.recommendation}

ğŸ› ï¸ æ¬¡ã«ã™ã¹ãã“ã¨:
${diagnosis.specificAction}

â±ï¸ ç¾åœ¨ã®è² è·: é€±${work.weeklyHours}æ™‚é–“

${diagnosis.score >= 70 ? 'âœ… ã€å„ªå…ˆåº¦ï¼šé«˜ã€‘ã™ãã«RPA/è‡ªå‹•åŒ–ã‚’æ¤œè¨ã™ã‚‹ã“ã¨ã‚’å¼·ããŠå‹§ã‚ã—ã¾ã™ï¼' : 
  diagnosis.score >= 40 ? 'âš¡ ã€å„ªå…ˆåº¦ï¼šä¸­ã€‘åŠ¹ç‡åŒ–ã«ã‚ˆã‚Šå¤§å¹…ãªæ™‚é–“å‰Šæ¸›ãŒæœŸå¾…ã§ãã¾ã™ã€‚' : 
  'ğŸ¤” ã€å„ªå…ˆåº¦ï¼šä½ã€‘ç¾çŠ¶ã§ã¯äººé–“ã®ä½œæ¥­ãŒé©ã—ã¦ã„ã¾ã™ãŒã€æ‰‹é †ã®è¦‹ç›´ã—ã¯å¯èƒ½ã§ã™ã€‚'}
            `;
            
            setTimeout(() => alert(message), 500);
        }
        
        // ä½œæ¥­ã‚’å‰Šé™¤
        function deleteWork(id) {
            if (confirm('ã“ã®ä½œæ¥­ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                works = works.filter(work => work.id !== id);
                updateDisplay();
                saveToStorage();
            }
        }
        
        // ç”»é¢ã‚’æ›´æ–°
        function updateDisplay() {
            updateWorkList();
            updateSummary();
            updateChart();
            updateDiagnosis();
        }
        
        // è¨ºæ–­çµæœã‚’æ›´æ–°
        function updateDiagnosis() {
            const diagnosisDiv = document.getElementById('diagnosis');
            const container = document.getElementById('diagnosisResults');
            
            if (works.length === 0) {
                diagnosisDiv.style.display = 'none';
                return;
            }
            
            // è‡ªå‹•åŒ–ã‚¹ã‚³ã‚¢é †ã«ã‚½ãƒ¼ãƒˆ
            const sortedWorks = works.map(work => ({
                ...work,
                diagnosis: diagnoseAutomation(work.name, work.frequency, work.duration)
            })).sort((a, b) => b.diagnosis.score - a.diagnosis.score);
            
            container.innerHTML = sortedWorks.map((work, index) => {
                const d = work.diagnosis;
                return `
                    <div class="diagnosis-item ${d.level}">
                        <div class="diagnosis-title">
                            ${index + 1}. ${work.name}
                            <span class="diagnosis-score ${d.level}">${d.levelText} ${d.score}%</span>
                        </div>
                        <div class="diagnosis-details">
                            é€±${work.weeklyHours}æ™‚é–“ (${getFrequencyText(work.frequency)} Ã— ${work.duration}åˆ†)
                            ${d.reasons.length > 0 ? 'ãƒ»' + d.reasons.join('ãƒ»') : ''}
                        </div>
                        <div class="diagnosis-recommendation">
                            ğŸ’¡ åŠ¹æœäºˆæ¸¬: ${d.recommendation}
                        </div>
                        <div class="diagnosis-recommendation" style="margin-top: 8px; background: rgba(52, 152, 219, 0.15);">
                            ğŸ› ï¸ å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³: ${d.specificAction}
                        </div>
                    </div>
                `;
            }).join('');
            
            diagnosisDiv.style.display = 'block';
        }
        
        // ä½œæ¥­ä¸€è¦§ã‚’æ›´æ–°
        function updateWorkList() {
            const container = document.getElementById('workItems');
            
            if (works.length === 0) {
                container.innerHTML = '<div class="no-data">ã¾ã ä½œæ¥­ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
                return;
            }
            
            container.innerHTML = works.map(work => {
                const freqText = getFrequencyText(work.frequency);
                const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                
                return `
                    <div class="work-item">
                        <div class="work-name">${work.name}</div>
                        <div class="work-details">${freqText} Ã— ${work.duration}åˆ†</div>
                        <div class="work-time">é€±${work.weeklyHours}æ™‚é–“</div>
                        <div class="automation-score" style="background: ${diagnosis.color}; position: absolute; right: 20px; top: 45px; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">
                            ${diagnosis.levelText} ${diagnosis.score}%
                        </div>
                        <button class="delete-btn" onclick="deleteWork(${work.id})">å‰Šé™¤</button>
                    </div>
                `;
            }).join('');
        }
        
        // é »åº¦ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›
        function getFrequencyText(freq) {
            if (freq === 5) return 'æ¯æ—¥';
            if (freq === 3) return 'é€±3å›';
            if (freq === 2) return 'é€±2å›';
            if (freq === 1) return 'é€±1å›';
            if (freq === 0.5) return 'æœˆæ•°å›';
            return `é€±${freq}å›`;
        }
        
        // ã‚µãƒãƒªãƒ¼ã‚’æ›´æ–°
        function updateSummary() {
            const summaryDiv = document.getElementById('summary');
            
            if (works.length === 0) {
                summaryDiv.style.display = 'none';
                return;
            }
            
            const totalWeekly = works.reduce((sum, work) => sum + work.weeklyHours, 0);
            const totalMonthly = totalWeekly * 4.3;
            
            document.getElementById('weeklyHours').textContent = totalWeekly.toFixed(1);
            document.getElementById('monthlyHours').textContent = Math.round(totalMonthly);
            document.getElementById('taskCount').textContent = works.length;
            
            summaryDiv.style.display = 'block';
        }
        
        // è‡ªå‹•åŒ–å¯èƒ½æ€§ã‚’è¨ºæ–­
        function diagnoseAutomation(workName, frequency, duration) {
            const weeklyMinutes = frequency * duration;
            let score = 0;
            let reasons = [];
            let recommendation = '';
            let specificAction = '';
            
            // åŸºæœ¬ã‚¹ã‚³ã‚¢ï¼ˆæ™‚é–“ã¨é »åº¦ï¼‰
            if (weeklyMinutes >= 120) { // é€±2æ™‚é–“ä»¥ä¸Š
                score += 30;
                reasons.push('é€±2æ™‚é–“ä»¥ä¸Šã®ä½œæ¥­');
            }
            if (frequency >= 3) { // é€±3å›ä»¥ä¸Š
                score += 25;
                reasons.push('é »ç¹ã«å®Ÿæ–½');
            }
            
            // ä½œæ¥­å†…å®¹ã«ã‚ˆã‚‹è©³ç´°åˆ¤å®š
            const name = workName.toLowerCase();
            if (name.includes('ãƒ‡ãƒ¼ã‚¿') || name.includes('å…¥åŠ›') || name.includes('è»¢è¨˜') || name.includes('ã‚³ãƒ”ãƒ¼')) {
                score += 40;
                reasons.push('ãƒ‡ãƒ¼ã‚¿å‡¦ç†ä½œæ¥­');
                recommendation = 'RPAå°å…¥ã§80-95%å‰Šæ¸›å¯èƒ½';
                specificAction = 'Power Automate Desktop ã‚„ UiPathç­‰ã®RPAãƒ„ãƒ¼ãƒ«ã‚’æ¤œè¨ã—ã¦ãã ã•ã„';
            } else if (name.includes('ãƒ¡ãƒ¼ãƒ«') || name.includes('é€£çµ¡') || name.includes('è¿”ä¿¡')) {
                score += 30;
                reasons.push('å®šå‹çš„ãªã‚„ã‚Šã¨ã‚Š');
                recommendation = 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ãƒ»è‡ªå‹•è¿”ä¿¡ã§50-70%å‰Šæ¸›å¯èƒ½';
                specificAction = 'Outlookã®å®šå‹æ–‡æ©Ÿèƒ½ã‚„è‡ªå‹•æŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¦ãã ã•ã„';
            } else if (name.includes('é›†è¨ˆ') || name.includes('è¨ˆç®—') || name.includes('ãƒ¬ãƒãƒ¼ãƒˆ') || name.includes('å ±å‘Š')) {
                score += 35;
                reasons.push('è¨ˆç®—ãƒ»é›†è¨ˆä½œæ¥­');
                recommendation = 'Excelè‡ªå‹•åŒ–ãƒ»BIãƒ„ãƒ¼ãƒ«ã§70-90%å‰Šæ¸›å¯èƒ½';
                specificAction = 'Excelãƒã‚¯ãƒ­ä½œæˆã€ã¾ãŸã¯Power BIãªã©ã®BIãƒ„ãƒ¼ãƒ«å°å…¥ã‚’æ¤œè¨ã—ã¦ãã ã•ã„';
            } else if (name.includes('è«‹æ±‚') || name.includes('ç™ºæ³¨') || name.includes('æ›¸é¡') || name.includes('å¥‘ç´„')) {
                score += 35;
                reasons.push('å®šå‹æ›¸é¡å‡¦ç†');
                recommendation = 'é›»å­åŒ–ãƒ»è‡ªå‹•å‡¦ç†ã§60-80%å‰Šæ¸›å¯èƒ½';
                specificAction = 'ã‚¯ãƒ©ã‚¦ãƒ‰è«‹æ±‚æ›¸ã‚·ã‚¹ãƒ†ãƒ ã‚„é›»å­å¥‘ç´„ã‚µãƒ¼ãƒ“ã‚¹ã®å°å…¥ã‚’æ¤œè¨ã—ã¦ãã ã•ã„';
            } else if (name.includes('åœ¨åº«') || name.includes('ç™ºæ³¨') || name.includes('ç®¡ç†')) {
                score += 30;
                reasons.push('ç®¡ç†æ¥­å‹™');
                recommendation = 'ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å°å…¥ã§40-70%å‰Šæ¸›å¯èƒ½';
                specificAction = 'åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚„ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ã‚’æ¤œè¨ã—ã¦ãã ã•ã„';
            } else if (name.includes('é›»è©±') || name.includes('æ¥å®¢') || name.includes('ç›¸è«‡') || name.includes('å¯¾å¿œ')) {
                score += 10;
                reasons.push('äººã¨ã®å¯¾è©±ãŒå¿…è¦');
                recommendation = 'FAQãƒ»ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç­‰ã§ä¸€éƒ¨æ”¯æ´å¯èƒ½';
                specificAction = 'ã‚ˆãã‚ã‚‹è³ªå•ã®FAQä½œæˆã‚„ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆå°å…¥ã§å¯¾å¿œæ•°ã‚’æ¸›ã‚‰ã›ã¾ã™';
            } else {
                score += 20;
                recommendation = 'æ¥­å‹™å†…å®¹ã®è©³ç´°ç¢ºèªãŒå¿…è¦';
                specificAction = 'ä½œæ¥­æ‰‹é †ã‚’è©³ã—ãåˆ†æã—ã€å®šå‹éƒ¨åˆ†ã®è‡ªå‹•åŒ–ã‚’æ¤œè¨ã—ã¦ãã ã•ã„';
            }
            
            // ã‚¹ã‚³ã‚¢èª¿æ•´
            score = Math.min(100, Math.max(0, score));
            
            // åˆ¤å®šãƒ¬ãƒ™ãƒ«
            let level = 'low';
            let levelText = 'è¦æ¤œè¨';
            let color = '#e74c3c';
            
            if (score >= 70) {
                level = 'high';
                levelText = 'RPAå°å…¥æ¨å¥¨';
                color = '#27ae60';
            } else if (score >= 40) {
                level = 'medium';
                levelText = 'åŠ¹ç‡åŒ–å¯èƒ½';
                color = '#f39c12';
            }
            
            return {
                score,
                level,
                levelText,
                color,
                reasons,
                recommendation,
                specificAction
            };
        }

        // ãƒãƒ£ãƒ¼ãƒˆã‚’æ›´æ–°
        function updateChart() {
            const canvas = document.getElementById('workChart');
            const noData = document.getElementById('noData');
            
            if (works.length === 0) {
                canvas.style.display = 'none';
                noData.style.display = 'block';
                if (chart) {
                    chart.destroy();
                    chart = null;
                }
                return;
            }
            
            canvas.style.display = 'block';
            noData.style.display = 'none';
            
            if (chart) {
                chart.destroy();
            }
            
            const ctx = canvas.getContext('2d');
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: works.map(work => work.name),
                    datasets: [{
                        data: works.map(work => work.weeklyHours),
                        backgroundColor: works.map(work => {
                            const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                            return diagnosis.color;
                        }),
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const work = works[context.dataIndex];
                                    const diagnosis = diagnoseAutomation(work.name, work.frequency, work.duration);
                                    return [
                                        context.label + ': ' + context.parsed + 'æ™‚é–“/é€±',
                                        'è‡ªå‹•åŒ–åº¦: ' + diagnosis.score + '% (' + diagnosis.levelText + ')'
                                    ];
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢
        function clearInputs() {
            document.getElementById('workName').value = '';
            document.getElementById('frequency').value = '';
            document.getElementById('duration').value = '';
        }
        
        // ã™ã¹ã¦ã‚¯ãƒªã‚¢
        function resetAll() {
            if (confirm('ã™ã¹ã¦ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                works = [];
                updateDisplay();
                saveToStorage();
            }
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
        function saveToStorage() {
            localStorage.setItem('workRecords', JSON.stringify(works));
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã¿
        function loadFromStorage() {
            const saved = localStorage.getItem('workRecords');
            if (saved) {
                works = JSON.parse(saved);
                updateDisplay();
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®å‡¦ç†
        document.addEventListener('DOMContentLoaded', function() {
            loadFromStorage();
            
            // ãƒ‡ãƒ¢ç”¨ï¼ˆå‰Šé™¤å¯èƒ½ï¼‰
            setTimeout(() => {
                if (works.length === 0 && confirm('ãƒ‡ãƒ¢ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã‹ï¼Ÿ')) {
                    const samples = [
                        { name: 'ãƒ¡ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯', frequency: 5, duration: 20 },
                        { name: 'ãƒ‡ãƒ¼ã‚¿å…¥åŠ›', frequency: 3, duration: 45 },
                        { name: 'é›»è©±å¯¾å¿œ', frequency: 5, duration: 15 }
                    ];
                    
                    samples.forEach(sample => {
                        const weeklyHours = (sample.frequency * sample.duration) / 60;
                        works.push({
                            id: Date.now() + Math.random(),
                            name: sample.name,
                            frequency: sample.frequency,
                            duration: sample.duration,
                            weeklyHours: Math.round(weeklyHours * 10) / 10
                        });
                    });
                    
                    updateDisplay();
                    saveToStorage();
                }
            }, 1000);
        });
    </script>
</body>
</html>